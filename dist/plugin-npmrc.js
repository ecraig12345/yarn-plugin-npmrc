/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-npmrc",
factory: function (require) {
"use strict";var plugin=(()=>{var Gt=Object.create;var B=Object.defineProperty;var Wt=Object.getOwnPropertyDescriptor;var Ut=Object.getOwnPropertyNames;var Vt=Object.getPrototypeOf,Jt=Object.prototype.hasOwnProperty;var j=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Y=(e,t)=>()=>(e&&(t=e(e=0)),t);var E=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),z=(e,t)=>{for(var r in t)B(e,r,{get:t[r],enumerable:!0})},Oe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ut(t))!Jt.call(e,s)&&s!==r&&B(e,s,{get:()=>t[s],enumerable:!(n=Wt(t,s))||n.enumerable});return e};var Q=(e,t,r)=>(r=e!=null?Gt(Vt(e)):{},Oe(t||!e||!e.__esModule?B(r,"default",{value:e,enumerable:!0}):r,e)),Kt=e=>Oe(B({},"__esModule",{value:!0}),e);var _e=E((on,Se)=>{var{hasOwnProperty:Z}=Object.prototype,ee=(e,t={})=>{typeof t=="string"&&(t={section:t}),t.align=t.align===!0,t.newline=t.newline===!0,t.sort=t.sort===!0,t.whitespace=t.whitespace===!0||t.align===!0,t.platform=t.platform||typeof process<"u"&&process.platform,t.bracketedArray=t.bracketedArray!==!1;let r=t.platform==="win32"?`\r
`:`
`,n=t.whitespace?" = ":"=",s=[],i=t.sort?Object.keys(e).sort():Object.keys(e),a=0;t.align&&(a=$(i.filter(o=>e[o]===null||Array.isArray(e[o])||typeof e[o]!="object").map(o=>Array.isArray(e[o])?`${o}[]`:o).concat([""]).reduce((o,l)=>$(o).length>=$(l).length?o:l)).length);let c="",f=t.bracketedArray?"[]":"";for(let o of i){let l=e[o];if(l&&Array.isArray(l))for(let p of l)c+=$(`${o}${f}`).padEnd(a," ")+n+$(p)+r;else l&&typeof l=="object"?s.push(o):c+=$(o).padEnd(a," ")+n+$(l)+r}t.section&&c.length&&(c="["+$(t.section)+"]"+(t.newline?r+r:r)+c);for(let o of s){let l=Pe(o,".").join("\\."),p=(t.section?t.section+".":"")+l,d=ee(e[o],{...t,section:p});c.length&&d.length&&(c+=r),c+=d}return c};function Pe(e,t){var r=0,n=0,s=0,i=[];do if(s=e.indexOf(t,r),s!==-1){if(r=s+t.length,s>0&&e[s-1]==="\\")continue;i.push(e.slice(n,s)),n=s+t.length}while(s!==-1);return i.push(e.slice(n)),i}var Ae=(e,t={})=>{t.bracketedArray=t.bracketedArray!==!1;let r=Object.create(null),n=r,s=null,i=/^\[([^\]]*)\]\s*$|^([^=]+)(=(.*))?$/i,a=e.split(/[\r\n]+/g),c={};for(let o of a){if(!o||o.match(/^\s*[;#]/)||o.match(/^\s*$/))continue;let l=o.match(i);if(!l)continue;if(l[1]!==void 0){if(s=H(l[1]),s==="__proto__"){n=Object.create(null);continue}n=r[s]=r[s]||Object.create(null);continue}let p=H(l[2]),d;t.bracketedArray?d=p.length>2&&p.slice(-2)==="[]":(c[p]=(c?.[p]||0)+1,d=c[p]>1);let u=d&&p.endsWith("[]")?p.slice(0,-2):p;if(u==="__proto__")continue;let w=l[3]?H(l[4]):!0,b=w==="true"||w==="false"||w==="null"?JSON.parse(w):w;d&&(Z.call(n,u)?Array.isArray(n[u])||(n[u]=[n[u]]):n[u]=[]),Array.isArray(n[u])?n[u].push(b):n[u]=b}let f=[];for(let o of Object.keys(r)){if(!Z.call(r,o)||typeof r[o]!="object"||Array.isArray(r[o]))continue;let l=Pe(o,".");n=r;let p=l.pop(),d=p.replace(/\\\./g,".");for(let u of l)u!=="__proto__"&&((!Z.call(n,u)||typeof n[u]!="object")&&(n[u]=Object.create(null)),n=n[u]);n===r&&d===p||(n[d]=r[o],f.push(o))}for(let o of f)delete r[o];return r},ve=e=>e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"),$=e=>typeof e!="string"||e.match(/[=\r\n]/)||e.match(/^\[/)||e.length>1&&ve(e)||e!==e.trim()?JSON.stringify(e):e.split(";").join("\\;").split("#").join("\\#"),H=e=>{if(e=(e||"").trim(),ve(e)){e.charAt(0)==="'"&&(e=e.slice(1,-1));try{e=JSON.parse(e)}catch{}}else{let t=!1,r="";for(let n=0,s=e.length;n<s;n++){let i=e.charAt(n);if(t)"\\;#".indexOf(i)!==-1?r+=i:r+="\\"+i,t=!1;else{if(";#".indexOf(i)!==-1)break;i==="\\"?t=!0:r+=i}}return t&&(r+="\\"),r.trim()}return e};Se.exports={parse:Ae,decode:Ae,stringify:ee,encode:ee,safe:$,unsafe:H}});var $e=E((an,Ne)=>{Ne.exports=Xt;function Xt(...e){let t=e;e.length===1&&(Array.isArray(e[0])||typeof e[0]=="string")&&(t=[].concat(e[0]));for(let s=0,i=t.length;s<i;s++)t[s]=typeof t[s]=="string"?t[s]:String(t[s]);t=t.sort(Yt);let r={},n="";for(let s=0,i=t.length;s<i;s++){let a=t[s],c=t[s+1]||"",f=!0,o=!0;if(a===c)continue;let l=0,p=a.length;for(;l<p;l++){let d=a.charAt(l);if(f=f&&d===c.charAt(l),o=o&&d===n.charAt(l),!f&&!o){l++;break}}if(n=a,l===p){r[a]=a;continue}for(let d=a.slice(0,l);l<=p;l++)r[d]=a,d+=a.charAt(l)}return r}function Yt(e,t){return e===t?0:e>t?1:-1}});var te=E((cn,Te)=>{Te.exports=process.env.DEBUG_NOPT||process.env.NOPT_DEBUG?(...e)=>console.error(...e):()=>{}});var ne=E((ln,De)=>{var Ce=j("url"),re=j("path"),qe=j("stream").Stream,zt=j("os"),ke=te();function Qt(e,t,r){e[t]=String(r)}function Zt(e,t,r){if(r===!0)return!1;if(r===null)return!0;r=String(r);let s=process.platform==="win32"?/^~(\/|\\)/:/^~\//,i=zt.homedir();return i&&r.match(s)?e[t]=re.resolve(i,r.slice(2)):e[t]=re.resolve(r),!0}function er(e,t,r){if(ke("validate Number %j %j %j",t,r,isNaN(r)),isNaN(r))return!1;e[t]=+r}function tr(e,t,r){let n=Date.parse(r);if(ke("validate Date %j %j %j",t,r,n),isNaN(n))return!1;e[t]=new Date(r)}function rr(e,t,r){typeof r=="string"?isNaN(r)?r==="null"||r==="false"?r=!1:r=!0:r=!!+r:r=!!r,e[t]=r}function nr(e,t,r){if(r=Ce.parse(String(r)),!r.host)return!1;e[t]=r.href}function sr(e,t,r){if(!(r instanceof qe))return!1;e[t]=r}De.exports={String:{type:String,validate:Qt},Boolean:{type:Boolean,validate:rr},url:{type:Ce,validate:nr},Number:{type:Number,validate:er},path:{type:re,validate:Zt},Stream:{type:qe,validate:sr},Date:{type:Date,validate:tr},Array:{type:Array}}});var Ge=E((fn,Fe)=>{var I=$e(),m=te(),ir=ne(),Le=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Me=(e,{types:t,dynamicTypes:r})=>{let n=Le(t,e),s=t[e];if(!n&&typeof r=="function"){let i=r(e);i!==void 0&&(s=i,n=!0)}return[n,s]},q=(e,t)=>t&&e===t,N=(e,t)=>t&&e.indexOf(t)!==-1,or=(e,t)=>t&&!N(e,t);function ar(e,{types:t,shorthands:r,typeDefs:n,invalidHandler:s,unknownHandler:i,abbrevHandler:a,typeDefault:c,dynamicTypes:f}={}){m(t,r,e,n);let o={},l={remain:[],cooked:e,original:e.slice(0)};return He(e,o,l.remain,{typeDefs:n,types:t,dynamicTypes:f,shorthands:r,unknownHandler:i,abbrevHandler:a}),Be(o,{types:t,dynamicTypes:f,typeDefs:n,invalidHandler:s,typeDefault:c}),o.argv=l,Object.defineProperty(o.argv,"toString",{value:function(){return this.original.map(JSON.stringify).join(" ")},enumerable:!1}),o}function Be(e,{types:t={},typeDefs:r={},dynamicTypes:n,invalidHandler:s,typeDefault:i}={}){let a=r.String?.type,c=r.Number?.type,f=r.Array?.type,o=r.Boolean?.type,l=r.Date?.type,p=typeof i<"u";p||(i=[!1,!0,null],a&&i.push(a),f&&i.push(f));let d={};Object.keys(e).forEach(u=>{if(u==="argv")return;let w=e[u];m("val=%j",w);let b=Array.isArray(w),[h,S]=Me(u,{types:t,dynamicTypes:n}),x=S;b||(w=[w]),x||(x=i),q(x,f)&&(x=i.concat(f)),Array.isArray(x)||(x=[x]),m("val=%j",w),m("types=",x),w=w.map(g=>{if(typeof g=="string"&&(m("string %j",g),g=g.trim(),g==="null"&&~x.indexOf(null)||g==="true"&&(~x.indexOf(!0)||N(x,o))||g==="false"&&(~x.indexOf(!1)||N(x,o))?(g=JSON.parse(g),m("jsonable %j",g)):N(x,c)&&!isNaN(g)?(m("convert to number",g),g=+g):N(x,l)&&!isNaN(Date.parse(g))&&(m("convert to date",g),g=new Date(g))),!h){if(!p)return g;S=i}g===!1&&~x.indexOf(null)&&!(~x.indexOf(!1)||N(x,o))&&(g=null);let _={};return _[u]=g,m("prevalidated val",_,g,S),se(_,u,g,S,{typeDefs:r})?(m("validated v",_,g,S),_[u]):(s?s(u,g,S,e):s!==!1&&m("invalid: "+u+"="+g,S),d)}).filter(g=>g!==d),!w.length&&or(x,f)?(m("VAL HAS NO LENGTH, DELETE IT",w,u,x.indexOf(f)),delete e[u]):b?(m(b,e[u],w),e[u]=w):e[u]=w[0],m("k=%s val=%j",u,w,e[u])})}function se(e,t,r,n,{typeDefs:s}={}){let i=s?.Array?.type;if(Array.isArray(n)){for(let f=0,o=n.length;f<o;f++)if(!q(n[f],i)&&se(e,t,r,n[f],{typeDefs:s}))return!0;return delete e[t],!1}if(q(n,i))return!0;if(n!==n)return m("Poison NaN",t,r,n),delete e[t],!1;if(r===n)return m("Explicitly allowed %j",r),e[t]=r,!0;let a=!1,c=Object.keys(s);for(let f=0,o=c.length;f<o;f++){m("test type %j %j %j",t,r,c[f]);let l=s[c[f]];if(l&&(n&&n.name&&l.type&&l.type.name?n.name===l.type.name:n===l.type)){let p={};if(a=l.validate(p,t,r)!==!1,r=p[t],a){e[t]=r;break}}}return m("OK? %j (%j %j %j)",a,t,r,c[c.length-1]),a||delete e[t],a}function He(e,t,r,{types:n={},typeDefs:s={},shorthands:i={},dynamicTypes:a,unknownHandler:c,abbrevHandler:f}={}){let o=s.String?.type,l=s.Number?.type,p=s.Array?.type,d=s.Boolean?.type;m("parse",e,t,r);let u=I(Object.keys(n));m("abbrevs=%j",u);let w=I(Object.keys(i));for(let b=0;b<e.length;b++){let h=e[b];if(m("arg",h),h.match(/^-{2,}$/)){r.push.apply(r,e.slice(b+1)),e[b]="--";break}let S=!1;if(h.charAt(0)==="-"&&h.length>1){let x=h.indexOf("=");if(x>-1){S=!0;let M=h.slice(x+1);h=h.slice(0,x),e.splice(b,1,h,M)}let g=Ie(h,w,u,{shorthands:i,abbrevHandler:f});if(m("arg=%j shRes=%j",h,g),g&&(e.splice.apply(e,[b,1].concat(g)),h!==g[0])){b--;continue}h=h.replace(/^-+/,"");let _=null;for(;h.toLowerCase().indexOf("no-")===0;)_=!_,h=h.slice(3);u[h]&&u[h]!==h&&(f?f(h,u[h]):f!==!1&&m(`abbrev: ${h} -> ${u[h]}`),h=u[h]);let[It,A]=Me(h,{types:n,dynamicTypes:a}),C=Array.isArray(A);C&&A.length===1&&(C=!1,A=A[0]);let X=q(A,p)||C&&N(A,p);!It&&Le(t,h)&&(Array.isArray(t[h])||(t[h]=[t[h]]),X=!0);let P,y=e[b+1],Ft=typeof _=="boolean"||q(A,d)||C&&N(A,d)||typeof A>"u"&&!S||y==="false"&&(A===null||C&&~A.indexOf(null));if(typeof A>"u"){let M=!S&&y&&!y?.startsWith("-")&&!["true","false"].includes(y);c?M?c(h,y):c(h):c!==!1&&(m(`unknown: ${h}`),M&&m(`unknown: ${y} parsed as normal opt`))}if(Ft){P=!_,(y==="true"||y==="false")&&(P=JSON.parse(y),y=null,_&&(P=!P),b++),C&&y&&(~A.indexOf(y)?(P=y,b++):y==="null"&&~A.indexOf(null)?(P=null,b++):!y.match(/^-{2,}[^-]/)&&!isNaN(y)&&N(A,l)?(P=+y,b++):!y.match(/^-[^-]/)&&N(A,o)&&(P=y,b++)),X?(t[h]=t[h]||[]).push(P):t[h]=P;continue}q(A,o)&&(y===void 0?y="":y.match(/^-{1,2}[^-]+/)&&(y="",b--)),y&&y.match(/^-{2,}$/)&&(y=void 0,b--),P=y===void 0?!0:y,X?(t[h]=t[h]||[]).push(P):t[h]=P,b++;continue}r.push(h)}}var Re=Symbol("singles"),cr=(e,t)=>{let r=t[Re];r||(r=Object.keys(t).filter(s=>s.length===1).reduce((s,i)=>(s[i]=!0,s),{}),t[Re]=r,m("shorthand singles",r));let n=e.split("").filter(s=>r[s]);return n.join("")===e?n:null};function Ie(e,...t){let{abbrevHandler:r,types:n={},shorthands:s={}}=t.length?t.pop():{},i=t[0]??I(Object.keys(s)),a=t[1]??I(Object.keys(n));if(e=e.replace(/^-+/,""),a[e]===e)return null;if(s[e])return s[e]&&!Array.isArray(s[e])&&(s[e]=s[e].split(/\s+/)),s[e];let c=cr(e,s);return c?c.map(f=>s[f]).reduce((f,o)=>f.concat(o),[]):a[e]&&!s[e]?null:(i[e]&&(r?r(e,i[e]):r!==!1&&m(`abbrev: ${e} -> ${i[e]}`),e=i[e]),s[e]&&!Array.isArray(s[e])&&(s[e]=s[e].split(/\s+/)),s[e])}Fe.exports={nopt:ar,clean:Be,parse:He,validate:se,resolveShort:Ie,typeDefs:ir}});var oe=E((v,We)=>{var ie=Ge(),lr=ne();We.exports=v=fr;v.clean=ur;v.typeDefs=lr;v.lib=ie;function fr(e,t,r=process.argv,n=2){return ie.nopt(r.slice(n),{types:e||{},shorthands:t||{},typeDefs:v.typeDefs,invalidHandler:v.invalidHandler,unknownHandler:v.unknownHandler,abbrevHandler:v.abbrevHandler})}function ur(e,t,r=v.typeDefs){return ie.clean(e,{types:t||{},typeDefs:r,invalidHandler:v.invalidHandler,unknownHandler:v.unknownHandler,abbrevHandler:v.abbrevHandler})}});var Ve=E((un,Ue)=>{var hr=Symbol("proc-log.meta");Ue.exports={META:hr,output:{LEVELS:["standard","error","buffer","flush"],KEYS:{standard:"standard",error:"error",buffer:"buffer",flush:"flush"},standard:function(...e){return process.emit("output","standard",...e)},error:function(...e){return process.emit("output","error",...e)},buffer:function(...e){return process.emit("output","buffer",...e)},flush:function(...e){return process.emit("output","flush",...e)}},log:{LEVELS:["notice","error","warn","info","verbose","http","silly","timing","pause","resume"],KEYS:{notice:"notice",error:"error",warn:"warn",info:"info",verbose:"verbose",http:"http",silly:"silly",timing:"timing",pause:"pause",resume:"resume"},error:function(...e){return process.emit("log","error",...e)},notice:function(...e){return process.emit("log","notice",...e)},warn:function(...e){return process.emit("log","warn",...e)},info:function(...e){return process.emit("log","info",...e)},verbose:function(...e){return process.emit("log","verbose",...e)},http:function(...e){return process.emit("log","http",...e)},silly:function(...e){return process.emit("log","silly",...e)},timing:function(...e){return process.emit("log","timing",...e)},pause:function(){return process.emit("log","pause")},resume:function(){return process.emit("log","resume")}},time:{LEVELS:["start","end"],KEYS:{start:"start",end:"end"},start:function(e,t){process.emit("time","start",e);function r(){return process.emit("time","end",e)}if(typeof t=="function"){let n=t();return n&&n.finally?n.finally(r):(r(),n)}return r},end:function(e){return process.emit("time","end",e)}},input:{LEVELS:["start","end","read"],KEYS:{start:"start",end:"end",read:"read"},start:function(e){process.emit("input","start");function t(){return process.emit("input","end")}if(typeof e=="function"){let r=e();return r&&r.finally?r.finally(t):(t(),r)}return t},end:function(){return process.emit("input","end")},read:function(...e){let t,r,n=new Promise((s,i)=>{t=s,r=i});return process.emit("input","read",t,r,...e),n}}}});var ce=E((hn,ae)=>{var F=oe(),pr=F.typeDefs.path.validate,dr=(e,t,r)=>typeof r!="string"?!1:pr(e,t,r);ae.exports={...F.typeDefs,path:{...F.typeDefs.path,validate:dr}};F.typeDefs=ae.exports});var Xe=E((pn,Ke)=>{var{URL:Je}=j("url");Ke.exports=e=>{let t=new Je(e),r=`${t.protocol}//${t.host}${t.pathname}`,n=new Je(".",r);return`//${n.host}${n.pathname}`}});var le=E((dn,Ye)=>{var gr=/(?<!\\)(\\*)\$\{([^${}?]+)(\?)?\}/g;Ye.exports=(e,t)=>e.replace(gr,(r,n,s,i)=>{let a=i==="?"?"":`\${${s}}`,c=t[s]!==void 0?t[s]:a;return n.length%2?r.slice((n.length+1)/2):n.slice(n.length/2)+c})});var Ze=E((gn,Qe)=>{var yr=le(),{resolve:ze}=j("path"),fe=(e,t,r,n=!1)=>{if(typeof e!="string"&&!Array.isArray(e))return e;let{platform:s,types:i,home:a,env:c}=r,f=new Set([].concat(i[t])),o=f.has(typeDefs.path.type),l=f.has(typeDefs.Boolean.type),p=o||f.has(typeDefs.String.type),d=f.has(typeDefs.Number.type),u=!n&&f.has(Array);if(Array.isArray(e))return u?e.map(w=>fe(w,t,r,!0)):e;if(e=e.trim(),u)return fe(e.split(`

`),t,r);if(l&&!p&&e==="")return!0;if(!p&&!o&&!d)switch(e){case"true":return!0;case"false":return!1;case"null":return null;case"undefined":return}return e=yr(e,c),o&&((s==="win32"?/^~(\/|\\)/:/^~\//).test(e)&&a?e=ze(a,e.slice(2)):e=ze(e)),d&&!isNaN(e)&&(e=+e),e};Qe.exports=fe});var tt=E((yn,et)=>{var T=class{constructor(t,r){this.key=t,this.type=r.type,this.default=r.default}},{url:{type:mr},path:{type:ue}}=ce(),wr={_auth:new T("_auth",{default:null,type:[null,String]}),global:new T("global",{default:!1,type:Boolean}),globalconfig:new T("globalconfig",{type:ue,default:""}),location:new T("location",{default:"user",type:["global","user","project"]}),prefix:new T("prefix",{type:ue,default:""}),registry:new T("registry",{default:"https://registry.npmjs.org/",type:mr}),userconfig:new T("userconfig",{default:"~/.npmrc",type:ue})};et.exports=wr});var st=E((mn,nt)=>{var rt=tt(),br=(e,t={})=>{for(let[r,n]of Object.entries(e)){let s=rt[r];s&&s.flatten?s.flatten(r,e,t):(/@.*:registry$/i.test(r)||/^\/\//.test(r))&&(t[r]=n)}return t};nt.exports={definitions:rt,flatten:br}});var ot=E((wn,it)=>{"use strict";var he=class extends Error{constructor(t){let r="Invalid auth configuration found: ";r+=t.map(n=>{if(n.action==="delete")return`\`${n.key}\` is not allowed in ${n.where} config`;if(n.action==="rename")return`\`${n.from}\` must be renamed to \`${n.to}\` in ${n.where} config`}).join(", "),r+="\nPlease run `npm config fix` to repair your configuration.`",super(r),this.code="ERR_INVALID_AUTH",this.problems=t}};it.exports={ErrInvalidAuth:he}});var ft=E((bn,lt)=>{var xr=_e(),pe=oe(),{log:R}=Ve(),{resolve:W,dirname:de,join:at}=j("path"),{homedir:Er}=j("os"),{readFile:jr,stat:Or}=j("fs/promises"),Ar=(...e)=>Or(W(...e)).then(t=>t.isFile()).catch(()=>!1),ge=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Pr=ce(),ct=Xe(),vr=le(),Sr=Ze(),{definitions:_r}=st(),Nr=new Set(["global","user","project"]),ye=new Set(["default","builtin",...Nr,"env"]),$r="env",me=class{#n=!1;#r="";#e="";constructor({npmPath:t,projectRoot:r,workspaceRoot:n,env:s=process.env,platform:i=process.platform,execPath:a=process.execPath,cwd:c=process.cwd()}){if(!r||!n)throw new Error("must provide projectRoot and workspaceRoot options");this.#r=r,this.#e=n;let f={},o={};for(let[d,u]of Object.entries(_r))o[d]=u.default,f[d]=u.type;this.types=f,this.defaults=o,this.npmPath=t,this.env=s,this.execPath=a,this.platform=i,this.cwd=c,this.globalPrefix=null,this.localPrefix=null,this.home=null;let l=[...ye];this.data=new Map;let p=null;for(let d of l)this.data.set(d,p=new we(p));this.data.set=()=>{throw new Error("cannot change internal config data structure")},this.data.delete=()=>{throw new Error("cannot change internal config data structure")},this.sources=new Map([]),this.list=[];for(let{data:d}of this.data.values())this.list.unshift(d);Object.freeze(this.list),this.#n=!1}get loaded(){return this.#n}get prefix(){return this.#t("global")?this.globalPrefix:this.localPrefix}get(t,r){if(!this.loaded)throw new Error("call config.load() before reading values");return this.#t(t,r)}#t(t,r=null){if(r!==null&&!ye.has(r))throw new Error("invalid config location param: "+r);let{data:n}=this.data.get(r||$r);return r===null||ge(n,t)?n[t]:void 0}async load(){if(this.loaded)throw new Error("attempting to load npm config multiple times");this.loadDefaults(),await this.loadBuiltinConfig(),this.loadEnv(),await this.loadProjectConfig(),await this.loadUserConfig(),await this.loadGlobalConfig(),this.#n=!0,this.globalPrefix=this.get("prefix")}loadDefaults(){this.loadGlobalPrefix(),this.loadHome();let t={...this.defaults,prefix:this.globalPrefix};try{t["npm-version"]=j(at(this.npmPath,"package.json")).version}catch{}this.#s(t,"default","default values");let{data:r}=this.data.get("default");Object.defineProperty(r,"globalconfig",{get:()=>W(this.#t("prefix"),"etc/npmrc"),set(n){Object.defineProperty(r,"globalconfig",{value:n,configurable:!0,writable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}loadHome(){this.home=this.env.HOME||Er()}loadGlobalPrefix(){if(this.globalPrefix)throw new Error("cannot load default global prefix more than once");this.env.PREFIX?this.globalPrefix=this.env.PREFIX:this.platform==="win32"?this.globalPrefix=de(this.execPath):(this.globalPrefix=de(de(this.execPath)),this.env.DESTDIR&&(this.globalPrefix=at(this.env.DESTDIR,this.globalPrefix)))}loadEnv(){let t=Object.create(null);for(let[r,n]of Object.entries(this.env)){if(!/^npm_config_/i.test(r)||n==="")continue;let s=r.slice(11);s.startsWith("//")||(s=s.replace(/(?!^)_/g,"-").toLowerCase()),t[s]=n}this.#s(t,"env","environment")}get valid(){for(let[t,{valid:r}]of this.data.entries())if(r===!1||r===null&&!this.validate(t))return!1;return!0}validate(t){if(t){let r=this.data.get(t);return r[L]=!0,pe.invalidHandler=(n,s,i)=>this.invalidHandler(n,s,i,r.source,t),pe.clean(r.data,this.types,Pr),pe.invalidHandler=null,r[L]}else{let r=!0,n=[];for(let s of this.data.keys()){if(s==="default"||s==="builtin")continue;let i=this.validate(s);if(r=r&&i,["global","user","project"].includes(s)){for(let c of["_authtoken","-authtoken"])this.get(c,s)&&n.push({action:"delete",key:c,where:s});let a=ct(this.get("registry"));for(let c of["_auth","_authToken","username","_password"])this.get(c,s)&&(c==="username"&&!this.get("_password",s)?n.push({action:"delete",key:c,where:s}):c==="_password"&&!this.get("username",s)?n.push({action:"delete",key:c,where:s}):n.push({action:"rename",from:c,to:`${a}:${c}`,where:s}))}}if(n.length){let{ErrInvalidAuth:s}=ot();throw new s(n)}return r}}isDefault(t){let[r,...n]=[...ye],s=this.data.get(r).data;return ge(s,t)&&n.every(i=>{let a=this.data.get(i).data;return!ge(a,t)})}invalidHandler(t,r,n,s,i){R.warn("invalid config",t+"="+JSON.stringify(r),`set in ${s}`),this.data.get(i)[L]=!1}#s(t,r,n,s=null){let i=this.data.get(r);if(i.source){let a=`double-loading "${r}" configs from ${n}, previously loaded from ${i.source}`;throw new Error(a)}if(this.sources.has(n)){let a=`double-loading config "${n}" as "${r}", previously loaded as "${this.sources.get(n)}"`;throw new Error(a)}if(i.source=n,this.sources.set(n,r),s)i.loadError=s,s.code!=="ENOENT"&&R.verbose("config",`error loading ${r} config`,s);else{i.raw=t;for(let[a,c]of Object.entries(t)){let f=vr(a,this.env),o=this.parseField(c,f);i.data[f]=o}}}parseField(t,r,n=!1){return Sr(t,r,this,n)}async#i(t,r){R.silly("config",`load:file:${t}`),await jr(t,"utf8").then(n=>{let s=xr.parse(n);return r==="project"&&s.prefix&&R.error("config",`prefix cannot be changed from project config: ${t}.`),this.#s(s,r,t)},n=>this.#s(null,r,t,n))}loadBuiltinConfig(){return this.#i(W(this.npmPath,"npmrc"),"builtin")}async loadProjectConfig(){if(await this.loadLocalPrefix(),this.#t("global")===!0||this.#t("location")==="global"){this.data.get("project").source="(global mode enabled, ignored)",this.sources.set(this.data.get("project").source,"project");return}let t=W(this.localPrefix,".npmrc");if(t!==this.#t("userconfig"))return this.#i(t,"project");this.data.get("project").source='(same as "user" config, ignored)',this.sources.set(this.data.get("project").source,"project")}async loadLocalPrefix(){this.#t("global")||this.#t("location")==="global"?this.localPrefix=this.#e:(this.#r!==this.#e&&await Ar(this.#e,".npmrc")&&R.warn("config",`ignoring workspace config at ${this.#e}/.npmrc`),this.localPrefix=this.#r)}loadUserConfig(){return this.#i(this.#t("userconfig"),"user")}loadGlobalConfig(){return this.#i(this.#t("globalconfig"),"global")}getCredentialsByURI(t){let r=ct(t),n={},s=this.get(`${r}:certfile`),i=this.get(`${r}:keyfile`);s&&i&&(n.certfile=s,n.keyfile=i);let a=this.get(`${r}:_authToken`);if(a)return n.token=a,n;let c=this.get(`${r}:username`),f=this.get(`${r}:_password`);if(c&&f){n.username=c,n.password=Buffer.from(f,"base64").toString("utf8");let l=`${n.username}:${n.password}`;return n.auth=Buffer.from(l,"utf8").toString("base64"),n}let o=this.get(`${r}:_auth`);if(o){let p=Buffer.from(o,"base64").toString("utf8").split(":");return n.username=p.shift(),n.password=p.join(":"),n.auth=o,n}return n}},G=Symbol("loadError"),L=Symbol("valid"),we=class{#n;#r=null;#e={};constructor(t){this.#n=Object.create(t&&t.data),this[L]=!0}get data(){return this.#n}get valid(){return this[L]}set source(t){if(this.#r)throw new Error("cannot set ConfigData source more than once");this.#r=t}get source(){return this.#r}set loadError(t){if(this[G]||Object.keys(this.#e).length)throw new Error("cannot set ConfigData loadError after load");this[G]=t}get loadError(){return this[G]}set raw(t){if(Object.keys(this.#e).length||this[G])throw new Error("cannot set ConfigData raw after load");this.#e=t}get raw(){return this.#e}};lt.exports=me});var ht=E(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.sync=k.isexe=void 0;var Tr=j("fs"),Cr=j("fs/promises"),qr=async(e,t={})=>{let{ignoreErrors:r=!1}=t;try{return ut(await(0,Cr.stat)(e),t)}catch(n){let s=n;if(r||s.code==="EACCES")return!1;throw s}};k.isexe=qr;var kr=(e,t={})=>{let{ignoreErrors:r=!1}=t;try{return ut((0,Tr.statSync)(e),t)}catch(n){let s=n;if(r||s.code==="EACCES")return!1;throw s}};k.sync=kr;var ut=(e,t)=>e.isFile()&&Dr(e,t),Dr=(e,t)=>{let r=t.uid??process.getuid?.(),n=t.groups??process.getgroups?.()??[],s=t.gid??process.getgid?.()??n[0];if(r===void 0||s===void 0)throw new Error("cannot get uid or gid");let i=new Set([s,...n]),a=e.mode,c=e.uid,f=e.gid,o=parseInt("100",8),l=parseInt("010",8),p=parseInt("001",8),d=o|l;return!!(a&p||a&l&&i.has(f)||a&o&&c===r||a&d&&r===0)}});var dt=E(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.sync=D.isexe=void 0;var Rr=j("fs"),Lr=j("fs/promises"),Mr=async(e,t={})=>{let{ignoreErrors:r=!1}=t;try{return pt(await(0,Lr.stat)(e),e,t)}catch(n){let s=n;if(r||s.code==="EACCES")return!1;throw s}};D.isexe=Mr;var Br=(e,t={})=>{let{ignoreErrors:r=!1}=t;try{return pt((0,Rr.statSync)(e),e,t)}catch(n){let s=n;if(r||s.code==="EACCES")return!1;throw s}};D.sync=Br;var Hr=(e,t)=>{let{pathExt:r=process.env.PATHEXT||""}=t,n=r.split(";");if(n.indexOf("")!==-1)return!0;for(let s=0;s<n.length;s++){let i=n[s].toLowerCase(),a=e.substring(e.length-i.length).toLowerCase();if(i&&a===i)return!0}return!1},pt=(e,t,r)=>e.isFile()&&Hr(t,r)});var yt=E(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0})});var jt=E(O=>{"use strict";var mt=O&&O.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ir=O&&O.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),wt=O&&O.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&mt(t,e,r);return Ir(t,e),t},Fr=O&&O.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&mt(t,e,r)};Object.defineProperty(O,"__esModule",{value:!0});O.sync=O.isexe=O.posix=O.win32=void 0;var bt=wt(ht());O.posix=bt;var xt=wt(dt());O.win32=xt;Fr(yt(),O);var Gr=process.env._ISEXE_TEST_PLATFORM_||process.platform,Et=Gr==="win32"?xt:bt;O.isexe=Et.isexe;O.sync=Et.sync});var Ct=E((Pn,Tt)=>{var{isexe:Wr,sync:Ur}=jt(),{join:Vr,delimiter:Jr,sep:Ot,posix:At}=j("path"),Pt=process.platform==="win32",vt=new RegExp(`[${At.sep}${Ot===At.sep?"":Ot}]`.replace(/(\\)/g,"\\$1")),Kr=new RegExp(`^\\.${vt.source}`),St=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),_t=(e,{path:t=process.env.PATH,pathExt:r=process.env.PATHEXT,delimiter:n=Jr})=>{let s=e.match(vt)?[""]:[...Pt?[process.cwd()]:[],...(t||"").split(n)];if(Pt){let i=r||[".EXE",".CMD",".BAT",".COM"].join(n),a=i.split(n).flatMap(c=>[c,c.toLowerCase()]);return e.includes(".")&&a[0]!==""&&a.unshift(""),{pathEnv:s,pathExt:a,pathExtExe:i}}return{pathEnv:s,pathExt:[""]}},Nt=(e,t)=>{let r=/^".*"$/.test(e)?e.slice(1,-1):e;return(!r&&Kr.test(t)?t.slice(0,2):"")+Vr(r,t)},$t=async(e,t={})=>{let{pathEnv:r,pathExt:n,pathExtExe:s}=_t(e,t),i=[];for(let a of r){let c=Nt(a,e);for(let f of n){let o=c+f;if(await Wr(o,{pathExt:s,ignoreErrors:!0})){if(!t.all)return o;i.push(o)}}}if(t.all&&i.length)return i;if(t.nothrow)return null;throw St(e)},Xr=(e,t={})=>{let{pathEnv:r,pathExt:n,pathExtExe:s}=_t(e,t),i=[];for(let a of r){let c=Nt(a,e);for(let f of n){let o=c+f;if(Ur(o,{pathExt:s,ignoreErrors:!0})){if(!t.all)return o;i.push(o)}}}if(t.all&&i.length)return i;if(t.nothrow)return null;throw St(e)};Tt.exports=$t;$t.sync=Xr});var U,be=Y(()=>{"use strict";U="yarn-plugin-npmrc"});var qt={};z(qt,{throwError:()=>J});function J(e){throw new V.ReportError(V.MessageName.UNNAMED,`[${U}] ${e.message||e}`)}var V,xe=Y(()=>{"use strict";V=j("@yarnpkg/core");be()});var Lt={};z(Lt,{loadNpmrc:()=>Yr});async function Yr(e){let t="";try{t=Dt.default.realpathSync(Rt.default.sync("npm"))}catch{J(`Couldn't find "npm" executable to help read the config`)}let r=["silly","verbose","info","http","timing","notice","warn","error"],n=r.indexOf(process.env.NPM_CONFIG_LOGLEVEL||process.env.npm_config_loglevel||"warn"),s=(i,...a)=>{r.indexOf(i)<n||console[i==="error"?"error":i==="warn"?"warn":"log"](`[${U}][${i}]`,...a)};process.on("log",s);try{let i=new kt.default({npmPath:t,...e});return await i.load(),i.validate(),i}catch(i){J(i)}finally{process.off("log",s)}}var kt,Dt,Rt,Mt=Y(()=>{"use strict";kt=Q(ft()),Dt=Q(j("fs")),Rt=Q(Ct());be();xe()});var nn={};z(nn,{default:()=>rn});var Bt=j("@yarnpkg/core"),zr={npmrcAuthEnabled:{description:"Attempt to read auth info from .npmrc for all registry requests",type:Bt.SettingsType.BOOLEAN,default:!1}},Qr="npmrcAuthEnabled",Ee,K,je={},Ht,Zr=e=>{Ht=e.getWorkspaceByCwd(e.cwd).cwd},en=async(e,t,{configuration:r})=>{if(!r.get(Qr)||!r.projectCwd)return e;if(t in je)return je[t];if(K)throw K;if(!Ee){let{loadNpmrc:i}=await Promise.resolve().then(()=>(Mt(),Lt));try{Ee=await i({projectRoot:r.projectCwd,workspaceRoot:Ht||r.projectCwd})}catch(a){throw K=a,K}}let n=Ee.getCredentialsByURI(t);if(n.certfile||n.keyfile){let{throwError:i}=await Promise.resolve().then(()=>(xe(),qt));i(`This plugin does not support certfile or keyfile auth (for registry "${t}")`)}let s;return"token"in n?s=`Bearer ${n.token}`:"auth"in n?s=`Basic ${n.auth}`:s=e,je[t]=s,s},tn={hooks:{validateProject:Zr,getNpmAuthenticationHeader:en},configuration:zr},rn=tn;return Kt(nn);})();
return plugin;
}
};
